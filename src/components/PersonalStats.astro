---
// Personal Stats component - displays code lines and movies watched
---

<div id="personal-stats" class="animate flex flex-wrap gap-4 text-sm text-gray-600 dark:text-gray-400 mb-4">
  <div class="flex items-center gap-1">
    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path>
    </svg>
    <span id="code-lines">100k+ lines of code written</span>
  </div>
  <div class="flex items-center gap-1">
    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
    </svg>
    <span id="movie-count">Loading movies...</span>
  </div>
</div>

<script>
  async function loadPersonalStats() {
    try {
      console.log('Loading personal stats...');
      const response = await fetch('/api/letterboxd-stats');
      const data = await response.json();
      
      console.log('Personal stats response:', data);
      
      const movieCountElement = document.getElementById('movie-count');
      if (movieCountElement) {
        if (data.success && data.movieCount > 0) {
          movieCountElement.textContent = `${data.movieCount.toLocaleString()}+ movies watched`;
        } else {
          movieCountElement.textContent = '500+ movies watched'; // Fallback
        }
      }
    } catch (error) {
      console.error('Error loading personal stats:', error);
      const movieCountElement = document.getElementById('movie-count');
      if (movieCountElement) {
        movieCountElement.textContent = '500+ movies watched'; // Fallback
      }
    }
  }
  
  // Load stats when component is visible
  document.addEventListener('DOMContentLoaded', () => {
    loadPersonalStats();
  });
  
  // Refresh stats when page becomes visible (user switches back to tab)
  document.addEventListener('visibilitychange', () => {
    if (!document.hidden) {
      loadPersonalStats();
    }
  });
</script>
